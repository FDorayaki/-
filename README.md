# 训练阶段

## 1. 数据准备

- **数据加载**：借助 `load_cifar10` 函数从指定目录加载 CIFAR-10 数据集的训练集与测试集。该函数会读取多个数据文件，把图像数据和标签数据分别合并到 `x_train`, `y_train`, `X_test`, `y_test` 之中。

- **数据预处理**：利用 `preprocess_data` 函数对加载的图像数据开展归一化和标准化处理。把图像像素值从整数类型转换为浮点数类型，并且计算训练集的均值和标准差，用这些统计量对训练集和测试集进行标准化操作，从而保证数据具有相同的尺度，有助于模型更快地收敛。

- **验证集划分**：从训练集中随机抽取一部分数据当作验证集，用于超参数调优和模型验证。通过随机选择索引的方式划分验证集，保证验证集和训练集的数据分布相似。

## 2. 模型初始化

- 构建 `ThreeLayerNet` 类的实例，对三层网络的参数进行初始化，包含权重矩阵 $W_1$, $W_2$, $W_3$ 和偏置向量 $b_1$, $b_2$, $b_3$。依据所选的激活函数类型，可能还会初始化可学习的负斜率参数（如 PReLU 激活函数的 $\alpha_1$ 和 $\alpha_2$）。隐藏层的权重矩阵采用 He 初始化方法，输出层的权重矩阵采用较小的随机初始化，偏置向量初始化为全零向量。

## 3. 超参数搜索

- 若要进行超参数搜索，可调用 `hyperparameter_search` 函数。该函数通过网格搜索的方式，遍历不同的超参数组合（学习率、隐藏层大小、正则化参数、激活函数），针对每个超参数组合创建一个新的模型并进行训练。在训练过程中，记录训练损失、验证损失和验证集准确率，最终找出在验证集上表现最优的超参数组合。

# 测试阶段

## 1. 模型加载

- 在训练过程中保存了模型的权重，在测试时加载最佳权重到模型中。

## 2. 测试集预测

- 调用 `test_model` 函数对测试集进行预测：

  - **前向传播**：将测试集输入到训练好的模型中，调用 `net.forward` 方法计算测试集的输出分数。
  - **预测结果**：依据输出分数，使用 `np.argmax` 函数得到预测的类别标签。
  - **准确率计算**：将预测的类别标签与真实标签进行比较，计算测试集的准确率。

## 3. 结果输出

- 打印测试集的准确率，以此评估模型的泛化能力。
